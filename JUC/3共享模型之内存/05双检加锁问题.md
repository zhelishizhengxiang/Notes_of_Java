![](assets/05双检加锁问题/file-20250913152842644.png)
![](assets/05双检加锁问题/file-20250913154048693.png)
* **也许 jvm 会指令重排。化为：先执行 24，再执行 21，即先复制给instance变量，完成初始化。**
* **即对new对象的过程不是原子的**
* 如果两个线程 t1，t2 按如下时间序列执行：

![](assets/05双检加锁问题/file-20250913154146579.png)
![](assets/05双检加锁问题/file-20250913154226214.png)
* 


所以正确的双检加锁单例模式如下图所示

![](assets/05双检加锁问题/file-20250913153143595.png)
![](assets/05双检加锁问题/file-20250913154801265.png)